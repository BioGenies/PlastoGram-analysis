---
title: "PlastoGram-results"
author: "Katarzyna Sidorczuk"
date: "7/17/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(knitr)
library(targets)
library(dplyr)
library(biogram)
library(measures)

source("./functions/filter_sequences.R")

tar_load(list.files("./_targets/objects"))

data_path <- "/media/kasia/Data/Dropbox/Projekty/BioNgramProjects/PlastoGram/"
```

## Numbers of sequences

```{r}
seq_types <- c("N_OM", "N_IM", "P_IM", "N_TM", "P_TM", "N_S", "P_S", "N_TL_TAT", "N_TL_SEC")
lapply(seq_types, function(ith_type) {
  s <- read_fasta(paste0(data_path, "Sequences/", ith_type, ".fa"))
  data.frame(Location = ith_type,
             `All sequences` = length(s),
             `With non-standard aa` = length(s) - length(filter_nonstandard_aa(s)),
             `After CD-HIT reduction` = length(get(paste0(ith_type, "_seqs"))),
             check.names = FALSE)
}) %>% bind_rows() %>% kable()
```

## Plastid_Nuclear model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(Plastid_Nuclear_CV_res_stats)
kable(table(Plastid_Nuclear_CV[["target"]], Plastid_Nuclear_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.00001
```{r}
kable(Plastid_Nuclear_CV_2_res_stats)
kable(table(Plastid_Nuclear_CV_2[["target"]], Plastid_Nuclear_CV_2[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(Plastid_Nuclear_cw_CV_res_stats)
kable(table(Plastid_Nuclear_cw_CV[["target"]], Plastid_Nuclear_cw_CV[["pred"]]))
```


## Membrane_Notmembrane model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(Membrane_Notmembrane_CV_res_stats)
kable(table(Membrane_Notmembrane_CV[["target"]], Membrane_Notmembrane_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(Membrane_Notmembrane_cw_CV_res_stats)
kable(table(Membrane_Notmembrane_cw_CV[["target"]], Membrane_Notmembrane_cw_CV[["pred"]]))
```


## Membrane_Plastid model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(Membrane_Plastid_CV_res_stats)
kable(table(Membrane_Plastid_CV[["target"]], Membrane_Plastid_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(Membrane_Plastid_cw_CV_res_stats)
kable(table(Membrane_Plastid_cw_CV[["target"]], Membrane_Plastid_cw_CV[["pred"]]))
```


## Membrane_Nuclear model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(Membrane_Nuclear_CV_res_stats)
kable(table(Membrane_Nuclear_CV[["target"]], Membrane_Nuclear_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.01
```{r}
kable(Membrane_Nuclear_CV_2_res_stats)
kable(table(Membrane_Nuclear_CV_2[["target"]], Membrane_Nuclear_CV_2[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.05
```{r}
kable(Membrane_Nuclear_CV_3_res_stats)
kable(table(Membrane_Nuclear_CV_3[["target"]], Membrane_Nuclear_CV_3[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(Membrane_Nuclear_cw_CV_res_stats)
kable(table(Membrane_Nuclear_cw_CV[["target"]], Membrane_Nuclear_cw_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(Membrane_Nuclear_cw_CV_2_res_stats)
kable(table(Membrane_Nuclear_cw_CV_2[["target"]], Membrane_Nuclear_cw_CV_2[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.05
```{r}
kable(Membrane_Nuclear_cw_CV_3_res_stats)
kable(table(Membrane_Nuclear_cw_CV_3[["target"]], Membrane_Nuclear_cw_CV_3[["pred"]]))
```


## Nuclear OM vs. other membrane model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(OM_other_membrane_CV_res_stats)
kable(table(OM_other_membrane_CV[["target"]], OM_other_membrane_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(OM_other_membrane_cw_CV_res_stats)
kable(table(OM_other_membrane_cw_CV[["target"]], OM_other_membrane_cw_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.01
```{r}
kable(OM_other_membrane_CV_2_res_stats)
kable(table(OM_other_membrane_CV_2[["target"]], OM_other_membrane_CV_2[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(OM_other_membrane_cw_CV_2_res_stats)
kable(table(OM_other_membrane_cw_CV_2[["target"]], OM_other_membrane_cw_CV_2[["pred"]]))
```


## Nuclear IM vs. other membrane model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(IM_other_membrane_CV_res_stats)
kable(table(IM_other_membrane_CV[["target"]], IM_other_membrane_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(IM_other_membrane_cw_CV_res_stats)
kable(table(IM_other_membrane_cw_CV[["target"]], IM_other_membrane_cw_CV[["pred"]]))
```

<!-- Model without class weights, QuiPT cut-off = 0.01 -->
<!-- ```{r} -->
<!-- kable(IM_other_membrane_CV_2_res_stats) -->
<!-- kable(table(IM_other_membrane_CV_2[["target"]], IM_other_membrane_CV_2[["pred"]])) -->
<!-- ``` -->

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(IM_other_membrane_cw_CV_2_res_stats)
kable(table(IM_other_membrane_cw_CV_2[["target"]], IM_other_membrane_cw_CV_2[["pred"]]))
```


## Nuclear TM vs. other membrane model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(TM_other_membrane_CV_res_stats)
kable(table(TM_other_membrane_CV[["target"]], TM_other_membrane_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(TM_other_membrane_cw_CV_res_stats)
kable(table(TM_other_membrane_cw_CV[["target"]], TM_other_membrane_cw_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.01
```{r}
kable(TM_other_membrane_CV_2_res_stats)
kable(table(TM_other_membrane_CV_2[["target"]], TM_other_membrane_CV_2[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(TM_other_membrane_cw_CV_2_res_stats)
kable(table(TM_other_membrane_cw_CV_2[["target"]], TM_other_membrane_cw_CV_2[["pred"]]))
```


## Stroma model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(Stroma_CV_res_stats)
kable(table(Stroma_CV[["target"]], Stroma_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(Stroma_cw_CV_res_stats)
kable(table(Stroma_cw_CV[["target"]], Stroma_cw_CV[["pred"]]))
```


## Plastid stroma model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(P_stroma_CV_res_stats)
kable(table(P_stroma_CV[["target"]], P_stroma_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(P_stroma_cw_CV_res_stats)
kable(table(P_stroma_cw_CV[["target"]], P_stroma_cw_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.01
```{r}
kable(P_stroma_CV_2_res_stats)
kable(table(P_stroma_CV[["target"]], P_stroma_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(P_stroma_cw_CV_2_res_stats)
kable(table(P_stroma_cw_CV_2[["target"]], P_stroma_cw_CV_2[["pred"]]))
```


## Nuclear stroma model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(N_stroma_CV_res_stats)
kable(table(N_stroma_CV[["target"]], N_stroma_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(N_stroma_cw_CV_res_stats)
kable(table(N_stroma_cw_CV[["target"]], N_stroma_cw_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.01
```{r}
kable(N_stroma_CV_2_res_stats)
kable(table(N_stroma_CV_2[["target"]], N_stroma_CV_2[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(N_stroma_cw_CV_2_res_stats)
kable(table(N_stroma_cw_CV_2[["target"]], N_stroma_cw_CV_2[["pred"]]))
```


## OM_Stroma model performance

Model without class weights, QuiPT cut-off = 0.001
```{r}
kable(OM_Stroma_CV_res_stats)
kable(table(OM_Stroma_CV[["target"]], OM_Stroma_CV[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.001
```{r}
kable(OM_Stroma_cw_CV_res_stats)
kable(table(OM_Stroma_cw_CV[["target"]], OM_Stroma_cw_CV[["pred"]]))
```

Model without class weights, QuiPT cut-off = 0.01
```{r}
kable(OM_Stroma_CV_2_res_stats)
kable(table(OM_Stroma_CV_2[["target"]], OM_Stroma_CV_2[["pred"]]))
```

Model with class weights, QuiPT cut-off = 0.01
```{r}
kable(OM_Stroma_cw_CV_2_res_stats)
kable(table(OM_Stroma_cw_CV_2[["target"]], OM_Stroma_cw_CV_2[["pred"]]))
```


## Tat model performance
```{r}
kable(TL_TAT_CV_res_stats)
tat_res <- mutate(TL_CV, pred = ifelse(Tat > Sec, "Tat", "Sec"))
kable(table(tat_res[["target"]], tat_res[["pred"]]))
```


## Sec model performance
```{r}
kable(TL_SEC_CV_res_stats)
sec_res <- mutate(TL_CV, pred = ifelse(Sec > Tat, "Sec", "Tat"))
kable(table(sec_res[["target"]], sec_res[["pred"]]))
```


